{"remainingRequest":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/thread-loader/dist/cjs.js!/home/spineor/Downloads/aelis4-web/vue-client/node_modules/babel-loader/lib/index.js!/home/spineor/Downloads/aelis4-web/vue-client/node_modules/eslint-loader/index.js??ref--13-0!/home/spineor/Downloads/aelis4-web/vue-client/src/plugins/permissions.js","dependencies":[{"path":"/home/spineor/Downloads/aelis4-web/vue-client/src/plugins/permissions.js","mtime":1566984596000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport authPermissions from '@/utils/auth/permissions';\nimport store from '@/store';\nvar CUTOFF_BEFORE_STR = 'before';\nvar CUTOFF_AFTER_STR = 'after';\n/** *\n*  This Mixin will evaluate the permission against the user role,\n*  and if the permission was configure to validate cutoff and status, that values will be take in count.\n*  The Permission has the following configuration\n    \"PERMISSION\": {\n        \"name\": \"namePermission:module\", <- This is the name of the permission configured on auth0\n        \"cutOffValidation\": [null | \"before\" | \"after\"], <- Indicates if apply when cutoff is closed of before. Let Null if is not neccessary the validation.\n        \"applyOnOrderStatus\": [null, 0, 1] <- Indicates in that status applies. (0: pending, 1: Finalized). Let Null if is not neccessary the validation.\n    }\n** */\n\n/*\n* Helper Method to get if the permission applies with the current cutoff .\n*/\n\nvar isValidCutOffPermission = function isValidCutOffPermission(permission) {\n  if (permission.cutOffValidation === CUTOFF_BEFORE_STR && !store.getters.orderEntry.cutoff.isClosed) {\n    return true;\n  }\n\n  if (permission.cutOffValidation === CUTOFF_AFTER_STR && store.getters.orderEntry.cutoff.isClosed) {\n    return true;\n  }\n\n  return false;\n};\n/*\n* Helper Method to get if the permission applies with the current order status .\n*/\n\n\nvar isValidStatusPermission = function isValidStatusPermission(permission, orderStatus) {\n  return orderStatus === permission.applyOnOrderStatus;\n};\n\nexport default {\n  install: function install(Vue) {\n    Vue.mixin({\n      data: function data() {\n        return {\n          permissions: authPermissions\n        };\n      },\n      methods: {\n        $can: function $can(permission, orderStatus) {\n          /* Step 0: validate permission not null */\n          if (!permission) {\n            return false;\n          }\n          /* Step 1: Verify if user has the required permission */\n\n\n          var hasCutoffPermission = true; // BY DEFAULT TRUE if cutOffValidation is null;\n\n          var hasStatusPermission = true; // BY DEFAULT TRUE if applyOnOrderStatus is null;\n\n          if (!store.getters.user.permissions.includes(permission.name)) {\n            return false;\n          }\n          /* Step 2: Verify if the permission has cutOffValidation, if case must be validate if cutoff is after or before.\n          Let Null if is not neccessary the validation. */\n\n\n          if (permission.cutOffValidation != null) {\n            hasCutoffPermission = isValidCutOffPermission(permission);\n          }\n          /* Step 3: Verify if the permission has applyOnOrderStatus, if case must be validate if orderStatus the same.\n          Let Null if is not neccessary the validation. */\n\n\n          if (permission.applyOnOrderStatus != null) {\n            hasStatusPermission = isValidStatusPermission(permission, orderStatus);\n          }\n\n          return hasCutoffPermission && hasStatusPermission;\n        }\n      }\n    });\n  }\n};",{"version":3,"sources":["/home/spineor/Downloads/aelis4-web/vue-client/src/plugins/permissions.js"],"names":["authPermissions","store","CUTOFF_BEFORE_STR","CUTOFF_AFTER_STR","isValidCutOffPermission","permission","cutOffValidation","getters","orderEntry","cutoff","isClosed","isValidStatusPermission","orderStatus","applyOnOrderStatus","install","Vue","mixin","data","permissions","methods","$can","hasCutoffPermission","hasStatusPermission","user","includes","name"],"mappings":";;;AAAA,OAAOA,eAAP,MAA4B,0BAA5B;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,IAAMC,iBAAiB,GAAG,QAA1B;AACA,IAAMC,gBAAgB,GAAG,OAAzB;AAEA;;;;;;;;;;;AAWA;;;;AAGA,IAAMC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,UAAD,EAAgB;AAC9C,MAAIA,UAAU,CAACC,gBAAX,KAAgCJ,iBAAhC,IAAqD,CAACD,KAAK,CAACM,OAAN,CAAcC,UAAd,CAAyBC,MAAzB,CAAgCC,QAA1F,EAAoG;AAClG,WAAO,IAAP;AACD;;AACD,MAAIL,UAAU,CAACC,gBAAX,KAAgCH,gBAAhC,IAAoDF,KAAK,CAACM,OAAN,CAAcC,UAAd,CAAyBC,MAAzB,CAAgCC,QAAxF,EAAkG;AAChG,WAAO,IAAP;AACD;;AACD,SAAO,KAAP;AACD,CARD;AAUA;;;;;AAGA,IAAMC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACN,UAAD,EAAaO,WAAb;AAAA,SAA6BA,WAAW,KAAKP,UAAU,CAACQ,kBAAxD;AAAA,CAAhC;;AAEA,eAAe;AACbC,EAAAA,OADa,mBACLC,GADK,EACA;AACXA,IAAAA,GAAG,CAACC,KAAJ,CAAU;AACRC,MAAAA,IADQ,kBACD;AACL,eAAO;AACLC,UAAAA,WAAW,EAAElB;AADR,SAAP;AAGD,OALO;AAMRmB,MAAAA,OAAO,EAAE;AACPC,QAAAA,IADO,gBACFf,UADE,EACUO,WADV,EACuB;AAC5B;AACA,cAAI,CAACP,UAAL,EAAiB;AACf,mBAAO,KAAP;AACD;AAED;;;AACA,cAAIgB,mBAAmB,GAAG,IAA1B,CAP4B,CAOI;;AAChC,cAAIC,mBAAmB,GAAG,IAA1B,CAR4B,CAQI;;AAChC,cAAI,CAACrB,KAAK,CAACM,OAAN,CAAcgB,IAAd,CAAmBL,WAAnB,CAA+BM,QAA/B,CAAwCnB,UAAU,CAACoB,IAAnD,CAAL,EAA+D;AAC7D,mBAAO,KAAP;AACD;AAED;;;;AAEA,cAAIpB,UAAU,CAACC,gBAAX,IAA+B,IAAnC,EAAyC;AACvCe,YAAAA,mBAAmB,GAAGjB,uBAAuB,CAACC,UAAD,CAA7C;AACD;AAED;;;;AAEA,cAAIA,UAAU,CAACQ,kBAAX,IAAiC,IAArC,EAA2C;AACzCS,YAAAA,mBAAmB,GAAGX,uBAAuB,CAACN,UAAD,EAAaO,WAAb,CAA7C;AACD;;AAED,iBAAOS,mBAAmB,IAAIC,mBAA9B;AACD;AA3BM;AAND,KAAV;AAoCD;AAtCY,CAAf","sourcesContent":["import authPermissions from '@/utils/auth/permissions';\nimport store from '@/store';\n\nconst CUTOFF_BEFORE_STR = 'before';\nconst CUTOFF_AFTER_STR = 'after';\n\n/** *\n*  This Mixin will evaluate the permission against the user role,\n*  and if the permission was configure to validate cutoff and status, that values will be take in count.\n*  The Permission has the following configuration\n    \"PERMISSION\": {\n        \"name\": \"namePermission:module\", <- This is the name of the permission configured on auth0\n        \"cutOffValidation\": [null | \"before\" | \"after\"], <- Indicates if apply when cutoff is closed of before. Let Null if is not neccessary the validation.\n        \"applyOnOrderStatus\": [null, 0, 1] <- Indicates in that status applies. (0: pending, 1: Finalized). Let Null if is not neccessary the validation.\n    }\n** */\n\n/*\n* Helper Method to get if the permission applies with the current cutoff .\n*/\nconst isValidCutOffPermission = (permission) => {\n  if (permission.cutOffValidation === CUTOFF_BEFORE_STR && !store.getters.orderEntry.cutoff.isClosed) {\n    return true;\n  }\n  if (permission.cutOffValidation === CUTOFF_AFTER_STR && store.getters.orderEntry.cutoff.isClosed) {\n    return true;\n  }\n  return false;\n};\n\n/*\n* Helper Method to get if the permission applies with the current order status .\n*/\nconst isValidStatusPermission = (permission, orderStatus) => orderStatus === permission.applyOnOrderStatus;\n\nexport default {\n  install(Vue) {\n    Vue.mixin({\n      data() {\n        return {\n          permissions: authPermissions\n        };\n      },\n      methods: {\n        $can(permission, orderStatus) {\n          /* Step 0: validate permission not null */\n          if (!permission) {\n            return false;\n          }\n\n          /* Step 1: Verify if user has the required permission */\n          let hasCutoffPermission = true; // BY DEFAULT TRUE if cutOffValidation is null;\n          let hasStatusPermission = true; // BY DEFAULT TRUE if applyOnOrderStatus is null;\n          if (!store.getters.user.permissions.includes(permission.name)) {\n            return false;\n          }\n\n          /* Step 2: Verify if the permission has cutOffValidation, if case must be validate if cutoff is after or before.\n          Let Null if is not neccessary the validation. */\n          if (permission.cutOffValidation != null) {\n            hasCutoffPermission = isValidCutOffPermission(permission);\n          }\n\n          /* Step 3: Verify if the permission has applyOnOrderStatus, if case must be validate if orderStatus the same.\n          Let Null if is not neccessary the validation. */\n          if (permission.applyOnOrderStatus != null) {\n            hasStatusPermission = isValidStatusPermission(permission, orderStatus);\n          }\n\n          return hasCutoffPermission && hasStatusPermission;\n        }\n      }\n    });\n  }\n};\n"]}]}