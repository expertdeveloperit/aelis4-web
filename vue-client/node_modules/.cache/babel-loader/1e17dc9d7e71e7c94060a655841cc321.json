{"remainingRequest":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/babel-loader/lib/index.js!/home/spineor/Downloads/aelis4-web/vue-client/node_modules/eslint-loader/index.js??ref--13-0!/home/spineor/Downloads/aelis4-web/vue-client/src/utils/auth/auth0Service.js","dependencies":[{"path":"/home/spineor/Downloads/aelis4-web/vue-client/src/utils/auth/auth0Service.js","mtime":1566297892000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _classCallCheck from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"/home/spineor/Downloads/aelis4-web/vue-client/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport auth0 from 'auth0-js';\nimport { EventEmitter } from 'events';\nimport authConfig from \"./auth_config\";\nvar webAuth = new auth0.WebAuth({\n  domain: authConfig.domain,\n  redirectUri: \"\".concat(window.location.origin, \"/callback\"),\n  clientID: process.env.VUE_APP_AUTH0_CLIENT_ID || 'test',\n  responseType: 'token id_token',\n  scope: 'openid profile email',\n  audience: process.env.VUE_APP_AUDIENCE || 'test',\n  leeway: 60\n});\nvar localStorageKey = 'loggedIn';\nvar loginEvent = 'loginEvent';\n\nvar AuthService =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  _inherits(AuthService, _EventEmitter);\n\n  function AuthService() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AuthService);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AuthService)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"idToken\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"accessToken\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"profile\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"tokenExpiry\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"accessTokenExpiry\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"defaultState\", '/');\n\n    _defineProperty(_assertThisInitialized(_this), \"errorMessage\", '');\n\n    return _this;\n  }\n\n  _createClass(AuthService, [{\n    key: \"login\",\n    value: function login(customState) {\n      webAuth.authorize({\n        appState: customState || this.defaultState,\n        errorMessage: window.localStorage.getItem('auth0AutenticationErrorMessage')\n      });\n      window.localStorage.setItem('auth0AutenticationErrorMessage', '');\n    }\n  }, {\n    key: \"logOut\",\n    value: function logOut() {\n      var _this2 = this;\n\n      localStorage.removeItem(localStorageKey);\n      this.idToken = null;\n      this.accessToken = null;\n      this.tokenExpiry = null;\n      this.profile = null;\n      this.accessTokenExpiry = null;\n      webAuth.logout({\n        returnTo: \"\".concat(window.location.origin)\n      });\n      setTimeout(function () {\n        _this2.emit(loginEvent, {\n          loggedIn: false\n        });\n      }, 500);\n    }\n  }, {\n    key: \"handleAuthentication\",\n    value: function handleAuthentication() {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        webAuth.parseHash(function (err, authResult) {\n          if (err) {\n            window.localStorage.setItem('auth0AutenticationErrorMessage', authConfig.errors[err.description] ? authConfig.errors[err.description].message : authConfig.errors[err.error].message);\n\n            _this3.logOut();\n\n            reject(err);\n          } else {\n            _this3.localLogin(authResult);\n\n            resolve(authResult.idToken);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"isAuthenticated\",\n    value: function isAuthenticated() {\n      return Date.now() < this.tokenExpiry && localStorage.getItem(localStorageKey) === 'true';\n    }\n  }, {\n    key: \"isIdTokenValid\",\n    value: function isIdTokenValid() {\n      return this.idToken && this.tokenExpiry && Date.now() < this.tokenExpiry;\n    }\n  }, {\n    key: \"isAccessTokenValid\",\n    value: function isAccessTokenValid() {\n      return this.accessToken && this.accessTokenExpiry && Date.now() < this.accessTokenExpiry;\n    }\n  }, {\n    key: \"getIdToken\",\n    value: function getIdToken() {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this4.isIdTokenValid()) {\n          resolve(_this4.idToken);\n        } else if (_this4.isAuthenticated()) {\n          _this4.renewTokens().then(function (authResult) {\n            resolve(authResult.idToken);\n          }, reject(new Error('Unable to renew authentication')));\n        } else {\n          resolve('Not Authenticated');\n        }\n      });\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function getAccessToken() {\n      var _this5 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this5.isAccessTokenValid()) {\n          resolve(_this5.accessToken);\n        } else {\n          _this5.renewTokens().then(function (authResult) {\n            resolve(authResult.accessToken);\n          }, reject);\n        }\n      });\n    }\n  }, {\n    key: \"localLogin\",\n    value: function localLogin(authResult) {\n      this.idToken = authResult.idToken;\n      this.profile = authResult.idTokenPayload;\n      this.accessToken = authResult.accessToken; // Convert the expiry time from seconds to milliseconds,\n      // required by the Date constructor\n\n      this.tokenExpiry = new Date(this.profile.exp * 1000); // Convert expiresIn to milliseconds and add the current time\n      // (expiresIn is a relative timestamp, we want an absolute time)\n\n      this.accessTokenExpiry = new Date(Date.now() + authResult.expiresIn * 1000);\n      localStorage.setItem(localStorageKey, 'true');\n      this.emit(loginEvent, {\n        loggedIn: true,\n        profile: authResult.idTokenPayload,\n        state: authResult.appState || {}\n      });\n    }\n  }, {\n    key: \"renewTokens\",\n    value: function renewTokens() {\n      var _this6 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (localStorage.getItem(localStorageKey) !== 'true') {\n          reject(new Error('Not logged in'));\n        }\n\n        webAuth.checkSession({}, function (err, authResult) {\n          if (err) {\n            reject(err);\n          } else {\n            _this6.localLogin(authResult);\n\n            resolve(authResult);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"changePassword\",\n    value: function changePassword() {\n      var _this7 = this;\n\n      return new Promise(function (resolve, reject) {\n        webAuth.changePassword({\n          connection: authConfig.databaseConnection,\n          email: _this7.profile.email\n        }, function (err, resp) {\n          if (err) {\n            reject(err);\n          } else {\n            resolve(resp);\n          }\n        });\n      });\n    }\n  }]);\n\n  return AuthService;\n}(EventEmitter);\n\nvar auth0Service = new AuthService();\nauth0Service.setMaxListeners(5);\nexport default auth0Service;",{"version":3,"sources":["/home/spineor/Downloads/aelis4-web/vue-client/src/utils/auth/auth0Service.js"],"names":["auth0","EventEmitter","authConfig","webAuth","WebAuth","domain","redirectUri","window","location","origin","clientID","process","env","VUE_APP_AUTH0_CLIENT_ID","responseType","scope","audience","VUE_APP_AUDIENCE","leeway","localStorageKey","loginEvent","AuthService","customState","authorize","appState","defaultState","errorMessage","localStorage","getItem","setItem","removeItem","idToken","accessToken","tokenExpiry","profile","accessTokenExpiry","logout","returnTo","setTimeout","emit","loggedIn","Promise","resolve","reject","parseHash","err","authResult","errors","description","message","error","logOut","localLogin","Date","now","isIdTokenValid","isAuthenticated","renewTokens","then","Error","isAccessTokenValid","idTokenPayload","exp","expiresIn","state","checkSession","changePassword","connection","databaseConnection","email","resp","auth0Service","setMaxListeners"],"mappings":"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","sourcesContent":["import auth0 from 'auth0-js';\r\nimport { EventEmitter } from 'events';\r\nimport authConfig from './auth_config';\r\n\r\nconst webAuth = new auth0.WebAuth({\r\n  domain: authConfig.domain,\r\n  redirectUri: `${window.location.origin}/callback`,\r\n  clientID: process.env.VUE_APP_AUTH0_CLIENT_ID || 'test',\r\n  responseType: 'token id_token',\r\n  scope: 'openid profile email',\r\n  audience: process.env.VUE_APP_AUDIENCE || 'test',\r\n  leeway: 60\r\n});\r\n\r\nconst localStorageKey = 'loggedIn';\r\nconst loginEvent = 'loginEvent';\r\n\r\nclass AuthService extends EventEmitter {\r\n  idToken = null;\r\n\r\n  accessToken = null;\r\n\r\n  profile = null;\r\n\r\n  tokenExpiry = null;\r\n\r\n  accessTokenExpiry = null;\r\n\r\n  defaultState = '/';\r\n\r\n  errorMessage = '';\r\n\r\n  login(customState) {\r\n    webAuth.authorize({\r\n      appState: customState || this.defaultState,\r\n      errorMessage: window.localStorage.getItem('auth0AutenticationErrorMessage')\r\n    });\r\n    window.localStorage.setItem('auth0AutenticationErrorMessage', '');\r\n  }\r\n\r\n  logOut() {\r\n    localStorage.removeItem(localStorageKey);\r\n\r\n    this.idToken = null;\r\n    this.accessToken = null;\r\n    this.tokenExpiry = null;\r\n    this.profile = null;\r\n    this.accessTokenExpiry = null;\r\n\r\n    webAuth.logout({\r\n      returnTo: `${window.location.origin}`\r\n    });\r\n\r\n    setTimeout(() => {\r\n      this.emit(loginEvent, { loggedIn: false });\r\n    }, 500);\r\n  }\r\n\r\n  handleAuthentication() {\r\n    return new Promise((resolve, reject) => {\r\n      webAuth.parseHash((err, authResult) => {\r\n        if (err) {\r\n          window.localStorage.setItem('auth0AutenticationErrorMessage', authConfig.errors[err.description] ? authConfig.errors[err.description].message : authConfig.errors[err.error].message);\r\n          this.logOut();\r\n          reject(err);\r\n        } else {\r\n          this.localLogin(authResult);\r\n          resolve(authResult.idToken);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  isAuthenticated() {\r\n    return (\r\n      Date.now() < this.tokenExpiry\r\n      && localStorage.getItem(localStorageKey) === 'true'\r\n    );\r\n  }\r\n\r\n  isIdTokenValid() {\r\n    return (\r\n      this.idToken\r\n      && this.tokenExpiry\r\n      && Date.now() < this.tokenExpiry\r\n    );\r\n  }\r\n\r\n  isAccessTokenValid() {\r\n    return (\r\n      this.accessToken\r\n      && this.accessTokenExpiry\r\n      && Date.now() < this.accessTokenExpiry\r\n    );\r\n  }\r\n\r\n  getIdToken() {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.isIdTokenValid()) {\r\n        resolve(this.idToken);\r\n      } else if (this.isAuthenticated()) {\r\n        this.renewTokens().then((authResult) => {\r\n          resolve(authResult.idToken);\r\n        }, reject(new Error('Unable to renew authentication')));\r\n      } else {\r\n        resolve('Not Authenticated');\r\n      }\r\n    });\r\n  }\r\n\r\n  getAccessToken() {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.isAccessTokenValid()) {\r\n        resolve(this.accessToken);\r\n      } else {\r\n        this.renewTokens().then((authResult) => {\r\n          resolve(authResult.accessToken);\r\n        }, reject);\r\n      }\r\n    });\r\n  }\r\n\r\n  localLogin(authResult) {\r\n    this.idToken = authResult.idToken;\r\n    this.profile = authResult.idTokenPayload;\r\n\r\n    this.accessToken = authResult.accessToken;\r\n\r\n    // Convert the expiry time from seconds to milliseconds,\r\n    // required by the Date constructor\r\n    this.tokenExpiry = new Date(this.profile.exp * 1000);\r\n\r\n    // Convert expiresIn to milliseconds and add the current time\r\n    // (expiresIn is a relative timestamp, we want an absolute time)\r\n    this.accessTokenExpiry = new Date(Date.now() + authResult.expiresIn * 1000);\r\n\r\n    localStorage.setItem(localStorageKey, 'true');\r\n\r\n    this.emit(loginEvent, {\r\n      loggedIn: true,\r\n      profile: authResult.idTokenPayload,\r\n      state: authResult.appState || {}\r\n    });\r\n  }\r\n\r\n  renewTokens() {\r\n    return new Promise((resolve, reject) => {\r\n      if (localStorage.getItem(localStorageKey) !== 'true') {\r\n        reject(new Error('Not logged in'));\r\n      }\r\n\r\n      webAuth.checkSession({}, (err, authResult) => {\r\n        if (err) {\r\n          reject(err);\r\n        } else {\r\n          this.localLogin(authResult);\r\n          resolve(authResult);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  changePassword() {\r\n    return new Promise((resolve, reject) => {\r\n      webAuth.changePassword({\r\n        connection: authConfig.databaseConnection,\r\n        email: this.profile.email\r\n      }, (err, resp) => {\r\n        if (err) {\r\n          reject(err);\r\n        } else {\r\n          resolve(resp);\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nconst auth0Service = new AuthService();\r\nauth0Service.setMaxListeners(5);\r\n\r\nexport default auth0Service;\r\n"]}]}